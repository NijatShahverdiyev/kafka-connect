{
  "name": "mongodb-connectors",
  "config": {
    "connector.class": "com.mongodb.kafka.connect.MongoSourceConnector",
    "connection.uri": "mongodb://mongo:27017/product-db",
    "collection": "products",
    "database": "product-db",
    "producer.override.linger.ms": 30,
    "producer.override.batch.size": 500000,
    "key.converter": "org.apache.kafka.connect.storage.StringConverter",
    "value.converter": "org.apache.kafka.connect.storage.StringConverter",
    "poll.max.batch.size": 1,
    "poll.await.time.ms": 20,
    "topic.namespace.map": "{\"*\":\"products.db.card-event-test\"}",
    "mongo.errors.log.enable": true,
    "mongo.errors.tolerance": "all",
    "errors.deadletterqueue.topic.name": "products.db.kafka-connector-dlt-test",
    "errors.deadletterqueue.context.headers.enable": true,
    "pipeline": "[{\"$match\":{\"$or\":[{\"operationType\":\"update\",\"fullDocument.type\":\"CARD\",\"$expr\":{\"$eq\":[{\"$getField\":{\"input\":\"$updateDescription.updatedFields\",\"field\":\"data.status\"}},\"Ready\"]}},{\"operationType\":\"insert\",\"fullDocument.type\":\"CARD\",\"fullDocument.data.status\":\"Ready\"}]}},{\"$project\":{\"_id\":1,\"ns\":1,\"fullDocument\":{\"userId\":\"$fullDocument.userId\",\"cardNumber\":\"$fullDocument.cardNumber\"}}}]",
    "transforms.Extract.predicate": "IsHeartbeat",
    "transforms.Extract.field": "fullDocument.userId",
    "transforms.Extract.type": "org.apache.kafka.connect.transforms.ExtractField$Key",
    "transforms": "Extract",
    "transforms.Extract.negate": true,
    "predicates.IsHeartbeat.type": "org.apache.kafka.connect.transforms.predicates.TopicNameMatches",
    "predicates": "IsHeartbeat",
    "predicates.IsHeartbeat.pattern": "__mongodb_heartbeats",
    "output.schema.key": "{\"type\": \"record\", \"name\": \"keySchema\", \"fields\" : [ { \"name\": \"fullDocument.userId\", \"type\": [\"string\", \"null\"]} ]}",
    "output.format.value": "json",
    "output.format.key": "schema",
    "publish.full.document.only": true,
    "full.document": "updateLookup"
  }
}
